var JsSearch=function(){function t(t){this.uidFieldName_=t,this.indexStrategy_=new PrefixIndexStrategy,this.pruningStrategy=new AllWordsMustMatchPruningStrategy,this.sanitizer_=new LowerCaseSanitizer,this.tokenizer_=new SimpleTokenizer,this.documents_=[],this.searchableFieldsMap_={},this.searchIndex_={}}return Object.defineProperty(t.prototype,"indexStrategy",{get:function(){return this.indexStrategy_},set:function(t){if(this.initialized_)throw Error("IIndexStrategy cannot be set after initialization");this.indexStrategy_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pruningStrategy",{get:function(){return this.pruningStrategy_},set:function(t){this.pruningStrategy_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sanitizer",{get:function(){return this.sanitizer_},set:function(t){if(this.initialized_)throw Error("ISanitizer cannot be set after initialization");this.sanitizer_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tokenizer",{get:function(){return this.tokenizer_},set:function(t){if(this.initialized_)throw Error("ITokenizer cannot be set after initialization");this.tokenizer_=t},enumerable:!0,configurable:!0}),t.prototype.addDocument=function(t){this.addDocuments([t])},t.prototype.addDocuments=function(t){this.documents_.push.apply(this.documents_,t),this.indexDocuments_(t,Object.keys(this.searchableFieldsMap_))},t.prototype.addIndex=function(t){this.searchableFieldsMap_[t]=!0,this.indexDocuments_(this.documents_,[t])},t.prototype.search=function(t){for(var e=this.tokenizer_.tokenize(this.sanitizer_.sanitize(t)),r=[],n=0,i=e.length;i>n;n++){var o=e[n];r.push(this.searchIndex_[o]||{})}var s=this.pruningStrategy_.prune(r),a=[];for(var p in s)a.push(s[p]);return a},t.prototype.indexDocuments_=function(t,e){this.initialized_=!0;for(var r=0,n=t.length;n>r;r++)for(var i=t[r],o=i[this.uidFieldName_],s=0,a=e.length;a>s;s++){var p=e[s],h=i[p];if("string"==typeof h)for(var u=this.tokenizer_.tokenize(this.sanitizer_.sanitize(h)),d=0,c=u.length;c>d;d++)for(var f=u[d],_=this.indexStrategy_.expandToken(f),g=0,l=_.length;l>g;g++){var y=_[g];this.searchIndex_[y]||(this.searchIndex_[y]={}),this.searchIndex_[y][o]=i}}},t}(),AllSubstringsIndexStrategy=function(){function t(){}return t.prototype.expandToken=function(t){for(var e=[],r=0,n=t.length;n>r;++r)for(var i="",o=r;n>o;++o)i+=t.charAt(o),e.push(i);return e},t}(),ExactWordIndexStrategy=function(){function t(){}return t.prototype.expandToken=function(t){return t?[t]:[]},t}(),PrefixIndexStrategy=function(){function t(){}return t.prototype.expandToken=function(t){for(var e=[],r="",n=0,i=t.length;i>n;++n)r+=t.charAt(n),e.push(r);return e},t}(),StopWordsIndexStrategyDecorator=function(){function t(t){this.decoratedIndexStrategy_=t,this.stopWordsMap_={},this.stopWordsMap_.a=!0,this.stopWordsMap_.about=!0,this.stopWordsMap_.an=!0,this.stopWordsMap_.are=!0,this.stopWordsMap_.as=!0,this.stopWordsMap_.at=!0,this.stopWordsMap_.be=!0,this.stopWordsMap_["by "]=!0,this.stopWordsMap_["for"]=!0,this.stopWordsMap_.from=!0,this.stopWordsMap_.how=!0,this.stopWordsMap_.i=!0,this.stopWordsMap_["in"]=!0,this.stopWordsMap_.is=!0,this.stopWordsMap_.it=!0,this.stopWordsMap_.of=!0,this.stopWordsMap_.on=!0,this.stopWordsMap_.or=!0,this.stopWordsMap_.that=!0,this.stopWordsMap_.the=!0,this.stopWordsMap_["this"]=!0,this.stopWordsMap_.to=!0,this.stopWordsMap_.was=!0,this.stopWordsMap_.what=!0,this.stopWordsMap_.when=!0,this.stopWordsMap_.where=!0,this.stopWordsMap_.who=!0,this.stopWordsMap_.will=!0,this.stopWordsMap_["with"]=!0}return t.prototype.expandToken=function(t){return this.stopWordsMap_[t]?[]:this.decoratedIndexStrategy_.expandToken(t)},t}(),AllWordsMustMatchPruningStrategy=function(){function t(){}return t.prototype.prune=function(t){for(var e={},r=0,n=t.length;n>r;r++){var i=t[r];if(0===r)for(var o in i)e[o]=i[o];else for(var o in e)i[o]||delete e[o]}return e},t}(),AnyWordsThatMatchPruningStrategy=function(){function t(){}return t.prototype.prune=function(t){for(var e={},r=0,n=t.length;n>r;r++){var i=t[r];for(var o in i)e[o]=i[o]}return e},t}(),CaseSensitiveSanitizer=function(){function t(){}return t.prototype.sanitize=function(t){return t?t.trim():""},t}(),LowerCaseSanitizer=function(){function t(){}return t.prototype.sanitize=function(t){return t?t.toLocaleLowerCase().trim():""},t}(),SimpleTokenizer=function(){function t(){}return t.prototype.tokenize=function(t){return t.split(/[^a-zA-Z0-9\-']+/).filter(function(t){return!!t})},t}(),TokenHighlighter=function(){function t(t,e,r){this.indexStrategy_=t||new PrefixIndexStrategy,this.sanitizer_=e||new LowerCaseSanitizer,this.wrapperTagName_=r||"mark"}return t.prototype.highlight=function(t,e){for(var r=this.wrapText_("").length,n={},i=0,o=e.length;o>i;i++)for(var s=this.sanitizer_.sanitize(e[i]),a=this.indexStrategy_.expandToken(s),p=0,h=a.length;h>p;p++){var u=a[p];n[u]?n[u].push(s):n[u]=[s]}for(var d="",c="",f=0,i=0,_=t.length;_>i;i++){var g=t.charAt(i);" "===g?(d="",c="",f=i+1):(d+=g,c+=this.sanitizer_.sanitize(g)),n[c]&&n[c].indexOf(c)>=0&&(d=this.wrapText_(d),t=t.substring(0,f)+d+t.substring(i+1),i+=r,_+=r)}return t},t.prototype.wrapText_=function(t){return"<"+this.wrapperTagName_+">"+t+"</"+this.wrapperTagName_+">"},t}();